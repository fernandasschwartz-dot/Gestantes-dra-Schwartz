<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>PRÃ‰-NATAL DRA. SCHWARTZ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --rosa1: #ec407a;
      --rosa2: #d81b60;
      --rosa3: #f48fb1;
      --rosa-claro: #ffe4ef;
      --titulo: #880e4f;
      --bg: #fff7fb;

      --risk-baixo: #e8f5e9;
      --risk-intermediario: #fff8e1;
      --risk-alto: #ffebee;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: var(--bg);
      color: #333;
    }

    header {
      background: var(--rosa1);
      text-align: center;
      color: white;
      padding: 25px 15px;
      border-bottom-left-radius: 20px;
      border-bottom-right-radius: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    header h1 {
      margin: 0;
      font-size: 26px;
      font-weight: 800;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    .gestante-icon {
      font-size: 30px;
    }

    .subtitle {
      font-size: 14px;
      margin-top: 5px;
    }

    .chip {
      display: inline-block;
      background: rgba(255,255,255,0.25);
      padding: 5px 12px;
      border-radius: 999px;
      margin: 3px;
      font-size: 12px;
    }

    .container {
      padding: 15px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .card {
      background: white;
      border: 1px solid var(--rosa3);
      padding: 18px;
      border-radius: 14px;
      margin-bottom: 20px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.08);
    }

    h2 {
      color: var(--titulo);
      margin-top: 0;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 18px;
    }

    input, select, textarea {
      width: 100%;
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      margin-top: 4px;
      font-size: 14px;
    }

    button {
      background: var(--rosa1);
      color: white;
      border: none;
      padding: 10px;
      font-size: 16px;
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: var(--rosa2);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    th {
      background: var(--rosa-claro);
      padding: 8px;
      font-weight: bold;
      color: var(--titulo);
      position: sticky;
      top: 0;
      z-index: 2;
    }

    td {
      padding: 6px;
      border-bottom: 1px solid #eee;
    }

    .risk-baixo {
      background: var(--risk-baixo);
      border-left: 4px solid #2e7d32;
    }

    .risk-intermediario {
      background: var(--risk-intermediario);
      border-left: 4px solid #ffa000;
    }

    .risk-alto {
      background: var(--risk-alto);
      border-left: 4px solid #c62828;
    }

    .badge {
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 11px;
      display: inline-block;
      margin-bottom: 2px;
    }

    .ok { background: #e8f5e9; color: #2e7d32; }
    .warn { background: #fff8e1; color: #ef6c00; }
    .neutral { background: #eceff1; color: #455a64; }
  </style>
</head>

<body>
<header>
  <h1><span class="gestante-icon">ðŸ¤°</span> PRÃ‰-NATAL DRA. SCHWARTZ</h1>
  <div class="subtitle">EstratificaÃ§Ã£o por risco + alertas automÃ¡ticos conforme o protocolo</div>
  <div>
    <span class="chip">ðŸŸ¢ Habitual</span>
    <span class="chip">ðŸŸ¡ IntermediÃ¡rio</span>
    <span class="chip">ðŸ”´ Alto risco</span>
  </div>
</header>

<div class="container">
  
  <div class="card">
    <h2>ðŸ¤° Cadastro de Gestante</h2>

    <!-- CAMPOS -->
    <label>Nome</label>
    <input id="nome">

    <label>Risco</label>
    <select id="risco">
      <option value="baixo">Risco habitual</option>
      <option value="intermediario">IntermediÃ¡rio</option>
      <option value="alto">Alto risco</option>
    </select>

    <label>DUM</label>
    <input type="date" id="dum">

    <label>Data da 1Âª US</label>
    <input type="date" id="dataUS">

    <label>IG na US (semanas)</label>
    <input type="number" id="usSemanas" min="0" max="42">

    <label>IG na US (dias)</label>
    <input type="number" id="usDias" min="0" max="6">

    <label>Justificativa do risco</label>
    <textarea id="justificativa"></textarea>

    <label>Exames 1Âº tri</label>
    <select id="ex1">
      <option value="pendente">Pendente</option>
      <option value="solicitado">Solicitado</option>
      <option value="realizado">Realizado</option>
    </select>

    <label>Exames 2Âº tri / TTOG</label>
    <select id="ex2">
      <option value="pendente">Pendente</option>
      <option value="solicitado">Solicitado</option>
      <option value="realizado">Realizado</option>
    </select>

    <label>Exames 3Âº tri</label>
    <select id="ex3">
      <option value="pendente">Pendente</option>
      <option value="solicitado">Solicitado</option>
      <option value="realizado">Realizado</option>
    </select>

    <label>Vacinas</label>
    <select id="vac">
      <option value="pendente">Pendente</option>
      <option value="ok">OK</option>
    </select>

    <label>Odontologia</label>
    <select id="od">
      <option value="pendente">Pendente</option>
      <option value="ok">OK</option>
    </select>

    <button onclick="salvar()">ðŸ’¾ Salvar gestante</button>
  </div>

  <!-- TABELA -->
  <div class="card">
    <h2>ðŸ“‹ Gestantes cadastradas</h2>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>IG Hoje</th>
          <th>DPP</th>
          <th>Risco</th>
          <th>Exames</th>
          <th>Alertas</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </div>

</div>

<script>
let gestantes = JSON.parse(localStorage.getItem("gestantesPN")) || [];

function calcularIG(dum, dataUS, usSem, usDia) {
  const hoje = new Date();
  let base;
  let diasBase = 0;

  if (dataUS && usSem !== "" && usDia !== "") {
    base = new Date(dataUS);
    diasBase = usSem * 7 + usDia;
  } else if (dum) {
    base = new Date(dum);
  } else return null;

  const diff = Math.floor((hoje - base) / 86400000);
  const total = diff + diasBase;
  return {
    semanas: Math.floor(total / 7),
    dias: total % 7,
    total
  };
}

function calcularDPP(dum, dataUS, usSem, usDia) {
  let base;

  if (dum) {
    base = new Date(dum);
  } else if (dataUS && usSem !== "" && usDia !== "") {
    const dataRef = new Date(dataUS);
    const total = usSem * 7 + usDia;
    base = new Date(dataRef.getTime() - total * 86400000);
  } else return "";

  const dpp = new Date(base.getTime() + 280 * 86400000);
  return dpp.toISOString().slice(0,10);
}

function gerarAlertas(ig) {
  if (!ig) return "";

  const w = ig.semanas;
  let a = [];

  if (w <= 13) a.push("Solicitar exames do 1Âº tri");
  if (w >= 20 && w <= 26) a.push("Solicitar US morfolÃ³gica 20â€“26s");
  if (w >= 24 && w <= 28) a.push("Solicitar TTOG 75 g + exames 2Âº tri");
  if (w >= 32 && w <= 36) a.push("Solicitar exames do 3Âº trimestre");
  if (w >= 34 && w <= 37) a.push("US 34â€“37 semanas");

  return a.join("<br>");
}

function salvar() {
  const g = {
    nome: document.getElementById("nome").value,
    risco: document.getElementById("risco").value,
    dum: document.getElementById("dum").value,
    dataUS: document.getElementById("dataUS").value,
    usSem: document.getElementById("usSemanas").value,
    usDia: document.getElementById("usDias").value,
    justificativa: document.getElementById("justificativa").value,
    ex1: document.getElementById("ex1").value,
    ex2: document.getElementById("ex2").value,
    ex3: document.getElementById("ex3").value,
    vac: document.getElementById("vac").value,
    od: document.getElementById("od").value
  };

  gestantes.push(g);
  localStorage.setItem("gestantesPN", JSON.stringify(gestantes));
  listar();
}

function listar() {
  const tabela = document.getElementById("lista");
  tabela.innerHTML = "";

  gestantes.forEach(g => {
    const ig = calcularIG(g.dum, g.dataUS, g.usSem, g.usDia);
    const dpp = calcularDPP(g.dum, g.dataUS, g.usSem, g.usDia);

    let riscoClass =
      g.risco === "baixo" ? "risk-baixo" :
      g.risco === "intermediario" ? "risk-intermediario" :
      "risk-alto";

    tabela.innerHTML += `
      <tr class="${riscoClass}">
        <td><b>ðŸ¤° ${g.nome}</b></td>
        <td>${ig ? `${ig.semanas}s ${ig.dias}d` : "-"}</td>
        <td>${dpp}</td>
        <td>${g.risco}</td>
        <td>
          <span class="badge neutral">1Âº tri: ${g.ex1}</span><br>
          <span class="badge neutral">2Âº tri: ${g.ex2}</span><br>
          <span class="badge neutral">3Âº tri: ${g.ex3}</span>
        </td>
        <td>${ig ? gerarAlertas(ig) : "-"}</td>
      </tr>
    `;
  });
}

listar();
</script>

</body>
</html>
